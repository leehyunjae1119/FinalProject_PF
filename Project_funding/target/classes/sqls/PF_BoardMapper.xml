<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="pf_board">

	<select id="selectBoardList" resultType="PF_BoardDto">
		SELECT * FROM PF_BOARD
	</select>
	
<!-- 	<select id="listPage" resultType="PF_BoardDto" > -->
<!-- 	<![CDATA[ SELECT BOARD_NO, BOARD_TITLE, BOARD_CONTENT,PROJECT_MONEY,PROJECT_TERM,RECRUIT_PERSONNEL, -->
<!-- 	BOARD_REGDATE,USER_NO FROM(SELECT  BOARD_NO, BOARD_TITLE, BOARD_CONTENT,PROJECT_MONEY,PROJECT_TERM,RECRUIT_PERSONNEL, -->
<!-- 	BOARD_REGDATE,USER_NO, RN  FROM(SELECT  BOARD_NO, BOARD_TITLE, BOARD_CONTENT,PROJECT_MONEY,PROJECT_TERM,RECRUIT_PERSONNEL, -->
<!-- 	BOARD_REGDATE,USER_NO, ROWNUM AS RN FROM (SELECT  BOARD_NO, BOARD_TITLE, BOARD_CONTENT,PROJECT_MONEY,PROJECT_TERM,RECRUIT_PERSONNEL, -->
<!-- 	BOARD_REGDATE,USER_NO FROM PF_BOARD ORDER BY BOARD_NO DESC))WHERE RN <= #{page} * 10) WHERE RN >=(#{page} -1) * 10 +1]]> -->
<!-- 	</select> -->

	<select id="listPage" resultType="PF_BoardDto" > 
	<![CDATA[ SELECT BOARD_NO, BOARD_TITLE, BOARD_CONTENT,PROJECT_MONEY,PROJECT_TERM,RECRUIT_PERSONNEL, RECRUIT_DATE, USER_NO,
	BOARD_REGDATE FROM(SELECT  BOARD_NO, BOARD_TITLE, BOARD_CONTENT,PROJECT_MONEY,PROJECT_TERM,RECRUIT_PERSONNEL, RECRUIT_DATE,USER_NO,
	BOARD_REGDATE, RN  FROM(SELECT  BOARD_NO, BOARD_TITLE, BOARD_CONTENT,PROJECT_MONEY,PROJECT_TERM,RECRUIT_PERSONNEL, RECRUIT_DATE, USER_NO,
	BOARD_REGDATE, ROWNUM AS RN FROM (SELECT  BOARD_NO, BOARD_TITLE, BOARD_CONTENT,PROJECT_MONEY,PROJECT_TERM,RECRUIT_PERSONNEL, RECRUIT_DATE,USER_NO,
	BOARD_REGDATE FROM PF_BOARD ORDER BY BOARD_NO DESC))WHERE RN <= #{page} * 10) WHERE RN >=(#{page} -1) * 10 +1]]>
 	</select> 
	
	<select id="totalCount" resultType="int">
		SELECT count(*) FROM PF_BOARD 
	</select>
	
	<select id="selectBoardCount" resultType="PF_BoardDto">
		SELECT COUNT(BOARD_NO) FROM PF_BOARD
	</select>
	
	<select id="insertBoard" resultType="PF_BoardDto">
		INSERT INTO PF_BOARD VALUES(PF_BOARD_SEQ.NEXTVAL, #{board_title}, #{board_content}, #{project_money}, #{project_term}, #{project_start_day}, #{recruit_date}, #{recruit_personnel}, #{project_category}, #{project_type}, NULL, '검수 중', TO_CHAR(SYSDATE, 'YYYY-MM-DD'), #{user_no})
	</select>
	
	<select id="updateBoard" parameterType="PF_BoardDto">
		UPDATE PF_BOARD SET BOARD_TITLE = #{board_title}, BOARD_CONTENT = #{board_content}, PROJECT_MONEY = #{project_money}, PROJECT_TERM = #{project_term}, PROJECT_START_DAY = #{project_start_day}, RECRUIT_DATE = #{recruit_date}, RECRUIT_PERSONNEL = #{recruit_personnel}, PROJECT_CATEGORY = #{project_category}, PROJECT_TYPE = #{project_type}, BOARD_FILE = #{board_file}, BOARD_REGDATE = SYSDATE WHERE BOARD_NO = #{board_no}
	</select>
	
	<select id="selectBoard" resultType="PF_BoardDto" parameterType="int">
		SELECT BOARD_NO, BOARD_TITLE, BOARD_CONTENT, PROJECT_MONEY, PROJECT_TERM, PROJECT_START_DAY, RECRUIT_DATE, RECRUIT_PERSONNEL, PROJECT_CATEGORY, PROJECT_TYPE, BOARD_FILE, PROJECT_STATE, BOARD_REGDATE, USER_NO FROM PF_BOARD WHERE BOARD_NO = #{board_no}
	</select>
	
	
	<!-- 댓글이 있을 경우에 댓글 먼저 삭제되고 글이 삭제되는 걸로 바꿔줘야 함 -->
	<select id="deleteBoard">
		DELETE FROM PF_BOARD WHERE BOARD_NO = #{board_no}
	</select>

</mapper>